{% extends "base_generic.html" %}
{% load static %}


{% block content %}
  <h2>Welcome, {{ user.username }}!</h2>
  <a href="{% url 'logout' %}">Logout</a>

  {% for number in floor_numbers %}
    <button class="floor-button" data-image="{{ number }}.png">{{ number }}</button>
  {% endfor %}



  <img id="floor-image" src="" alt="Floor image" style="display: none;">
  <h3>Add sensor</h3>
  <form id="sensor-form">
      <label for="sensor-name">Sensor Name:</label><br>
      <input type="text" id="sensor-name" name="sensor-name"><br>
      <label for="sensor-type">Sensor Type:</label><br>
      <select id="sensor-type" name="sensor-type">
          <option value="mult">Multi-Sensor</option>
          <option value="wet">Wet-Sensor</option>
      </select><br>
      <label for="sensor-x">X-coordinate:</label><br>
      <input type="number" id="sensor-x" name="sensor-x" min="0"><br>
      <label for="sensor-y">Y-coordinate:</label><br>
      <input type="number" id="sensor-y" name="sensor-y" min="0"><br>
      <input type="submit" value="Add Sensor">
  </form>

{% endblock %}

{% block extra_js %}
<script>
    var staticUrl = "{% get_static_prefix %}";

    document.querySelectorAll('.floor-button').forEach(function(button) {
        button.addEventListener('click', function(event) {
            var imageFile = event.target.getAttribute('data-image');
            var imageUrl = staticUrl + "{{ user.username }}/объект " + imageFile;
            var imageElement = document.getElementById('floor-image');
            imageElement.src = imageUrl;
            imageElement.style.display = 'block';

            // Display sensors for this floor
            var sensorsContainer = document.getElementById('sensors-container');
            sensorsContainer.style.display = 'block';
            sensorsContainer.style.width = imageElement.width + 'px';
            sensorsContainer.style.height = imageElement.height + 'px';

            document.querySelectorAll('.sensor-button').forEach(function(button) {
                button.style.display = button.getAttribute('data-floor') === event.target.innerText ? 'block' : 'none';
            });
        });
    });
</script>
{% endblock %}


